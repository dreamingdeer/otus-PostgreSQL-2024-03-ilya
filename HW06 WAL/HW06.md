## Цель:

    уметь работать с журналами и контрольными точками
    уметь настраивать параметры журналов


## Описание/Пошаговая инструкция выполнения домашнего задания:

    Настройте выполнение контрольной точки раз в 30 секунд.
    10 минут c помощью утилиты pgbench подавайте нагрузку.
    Измерьте, какой объем журнальных файлов был сгенерирован за это время. Оцените, какой объем приходится в среднем на одну контрольную точку.
    Проверьте данные статистики: все ли контрольные точки выполнялись точно по расписанию. Почему так произошло?
    Сравните tps в синхронном/асинхронном режиме утилитой pgbench. Объясните полученный результат.
    Создайте новый кластер с включенной контрольной суммой страниц. Создайте таблицу. Вставьте несколько значений. Выключите кластер. Измените пару байт в таблице. Включите кластер и сделайте выборку из таблицы. Что и почему произошло? как проигнорировать ошибку и продолжить работу?


pg_stat_checkpointer

checkpoint_timeout
full_page_writes 
checkpoint_completion_target 0.9 default after 13

SELECT * FROM pg_stat_bgwriter \gx

SELECT * FROM pg_stat_checkpointer \gx


ALTER SYSTEM SET synchronous_commit = off;

 В режиме off ожидание отсутствует, поэтому может образоваться окно от момента, когда клиент узнаёт об успешном завершении, до момента, когда транзакция действительно гарантированно защищена от сбоя. (Максимальный размер окна равен тройному значению wal_writer_delay.)

postgres=# show wal_writer_delay ;
 wal_writer_delay 
------------------
 200ms
(1 row)


show fsync;
show wal_sync_method;
show data_checksums;


log_checkpoints

При попытке восстановить страницы после повреждения иногда нужно обойти защиту, обеспечиваемую контрольными суммами. Для этого можно временно установить параметр конфигурации ignore_checksum_failure.